{"version":3,"file":"whatsnew.routes.js","names":["express","require","router","Router","WhatsNew","asyncHandler","getActiveContentsByLangId","req","res","langid","query","contents","aggregate","$match","Language","$lookup","from","localField","foreignField","as","pipeline","Languages","Page","$ne","status","json","ApiResponse","error","message","route","get","module","exports"],"sources":["../../../src/app/routes/whatsnew.routes.js"],"sourcesContent":["const express = require(\"express\");\nconst router = express.Router();\nconst WhatsNew = require(\"../../admin/models/whatsnew/whatsnewContent\");\nconst asyncHandler = require(\"../utils/asyncHandler\");\n\nconst getActiveContentsByLangId = asyncHandler(async (req, res) => {\n\tconst { langid } = req.query;\n\ttry {\n\t\tconst contents = await WhatsNew.aggregate([\n\t\t\t{\n\t\t\t\t$match: {\n\t\t\t\t\tLanguage: langid,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\t$lookup: {\n\t\t\t\t\tfrom: \"whatsnews\",\n\t\t\t\t\tlocalField: \"Page\",\n\t\t\t\t\tforeignField: \"_id\",\n\t\t\t\t\tas: \"Page\",\n\t\t\t\t\tpipeline: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$match: {\n\t\t\t\t\t\t\t\tLanguages: langid,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\t$match: {\n\t\t\t\t\tPage: {\n\t\t\t\t\t\t$ne: null || [],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t]);\n\n\t\tres.status(200).json(\n\t\t\tnew ApiResponse(\n\t\t\t\t200,\n\t\t\t\t{\n\t\t\t\t\tcontents,\n\t\t\t\t},\n\t\t\t\t\"Pages fetched Successfully\"\n\t\t\t)\n\t\t);\n\t} catch (error) {\n\t\tres.status(500).json({ message: error.message });\n\t}\n});\n\nrouter.route(\"/contents/:langid\").get(getActiveContentsByLangId);\n\nmodule.exports = router;\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAMC,QAAQ,GAAGH,OAAO,CAAC,6CAA6C,CAAC;AACvE,MAAMI,YAAY,GAAGJ,OAAO,CAAC,uBAAuB,CAAC;AAErD,MAAMK,yBAAyB,GAAGD,YAAY,CAAC,OAAOE,GAAG,EAAEC,GAAG,KAAK;EAClE,MAAM;IAAEC;EAAO,CAAC,GAAGF,GAAG,CAACG,KAAK;EAC5B,IAAI;IACH,MAAMC,QAAQ,GAAG,MAAMP,QAAQ,CAACQ,SAAS,CAAC,CACzC;MACCC,MAAM,EAAE;QACPC,QAAQ,EAAEL;MACX;IACD,CAAC,EACD;MACCM,OAAO,EAAE;QACRC,IAAI,EAAE,WAAW;QACjBC,UAAU,EAAE,MAAM;QAClBC,YAAY,EAAE,KAAK;QACnBC,EAAE,EAAE,MAAM;QACVC,QAAQ,EAAE,CACT;UACCP,MAAM,EAAE;YACPQ,SAAS,EAAEZ;UACZ;QACD,CAAC;MAEH;IACD,CAAC,EACD;MACCI,MAAM,EAAE;QACPS,IAAI,EAAE;UACLC,GAAG,EAAE,IAAI,IAAI;QACd;MACD;IACD,CAAC,CACD,CAAC;IAEFf,GAAG,CAACgB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CACnB,IAAIC,WAAW,CACd,GAAG,EACH;MACCf;IACD,CAAC,EACD,4BACD,CACD,CAAC;EACF,CAAC,CAAC,OAAOgB,KAAK,EAAE;IACfnB,GAAG,CAACgB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEG,OAAO,EAAED,KAAK,CAACC;IAAQ,CAAC,CAAC;EACjD;AACD,CAAC,CAAC;AAEF1B,MAAM,CAAC2B,KAAK,CAAC,mBAAmB,CAAC,CAACC,GAAG,CAACxB,yBAAyB,CAAC;AAEhEyB,MAAM,CAACC,OAAO,GAAG9B,MAAM","ignoreList":[]}