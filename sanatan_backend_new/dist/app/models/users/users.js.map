{"version":3,"file":"users.js","names":["mongoose","require","jwt","bcrypt","Schema","userSchema","username","type","String","required","unique","lowercase","trim","index","fullName","userId","email","userPic","gender","default","otp","otpExpires","Date","phone","address","city","state","country","pin","donationHistory","Array","history","password","refreshToken","timestamps","pre","next","isModified","hash","methods","isPasswordCorrect","compare","generateAccessToken","sign","_id","process","env","ACCESS_TOKEN_SECRET","expiresIn","APP_ACCESS_TOKEN_EXPIRY","generateRefreshToken","REFRESH_TOKEN_SECRET","APP_REFRESH_TOKEN_EXPIRY","User","model","module","exports"],"sources":["../../../../src/app/models/users/users.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\nconst jwt = require(\"jsonwebtoken\");\nconst bcrypt = require(\"bcrypt\");\nconst { Schema } = mongoose;\n\nconst userSchema = new mongoose.Schema(\n\t{\n\t\tusername: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tunique: true,\n\t\t\tlowercase: true,\n\t\t\ttrim: true,\n\t\t\tindex: true,\n\t\t},\n\t\tfullName: {\n\t\t\ttype: String,\n\t\t},\n\t\tuserId: {\n\t\t\ttype: String,\n\t\t},\n\t\temail: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tunique: true,\n\t\t\tlowercase: true,\n\t\t\ttrim: true,\n\t\t},\n\t\tuserPic: {\n\t\t\ttype: String,\n\t\t},\n\t\tgender: {\n\t\t\ttype: String,\n\t\t\tdefault: \"\",\n\t\t},\n\t\totp: { type: String },\n\t\totpExpires: { type: Date },\n\t\tphone: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tunique: true,\n\t\t\tlowercase: true,\n\t\t\ttrim: true,\n\t\t},\n\t\taddress: {\n\t\t\ttype: String,\n\t\t},\n\t\tcity: {\n\t\t\ttype: String,\n\t\t},\n\t\tstate: {\n\t\t\ttype: String,\n\t\t},\n\t\tcountry: {\n\t\t\ttype: String,\n\t\t},\n\t\tpin: {\n\t\t\ttype: String,\n\t\t},\n\t\tdonationHistory: {\n\t\t\ttype: Array,\n\t\t},\n\t\thistory: {\n\t\t\ttype: Array,\n\t\t},\n\t\tpassword: {\n\t\t\ttype: String,\n\t\t\trequired: [true, \"Password is required\"],\n\t\t},\n\t\trefreshToken: {\n\t\t\ttype: String,\n\t\t},\n\t},\n\t{\n\t\ttimestamps: true,\n\t}\n);\n\nuserSchema.pre(\"save\", async function (next) {\n\tif (!this.isModified(\"password\")) return next();\n\n\tthis.password = await bcrypt.hash(this.password, 10);\n\tnext();\n});\n\nuserSchema.methods.isPasswordCorrect = async function (password) {\n\treturn await bcrypt.compare(password, this.password);\n};\n\nuserSchema.methods.generateAccessToken = function () {\n\treturn jwt.sign(\n\t\t{\n\t\t\t_id: this._id,\n\t\t\temail: this.email,\n\t\t\tusername: this.username,\n\t\t\tfullName: this.fullName,\n\t\t},\n\t\tprocess.env.ACCESS_TOKEN_SECRET,\n\t\t{\n\t\t\texpiresIn: process.env.APP_ACCESS_TOKEN_EXPIRY,\n\t\t}\n\t);\n};\nuserSchema.methods.generateRefreshToken = function () {\n\treturn jwt.sign(\n\t\t{\n\t\t\t_id: this._id,\n\t\t},\n\t\tprocess.env.REFRESH_TOKEN_SECRET,\n\t\t{\n\t\t\texpiresIn: process.env.APP_REFRESH_TOKEN_EXPIRY,\n\t\t}\n\t);\n};\n\nconst User = mongoose.model(\"User\", userSchema);\nmodule.exports = User;\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpC,MAAMC,GAAG,GAAGD,OAAO,CAAC,cAAc,CAAC;AACnC,MAAME,MAAM,GAAGF,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAM;EAAEG;AAAO,CAAC,GAAGJ,QAAQ;AAE3B,MAAMK,UAAU,GAAG,IAAIL,QAAQ,CAACI,MAAM,CACrC;EACCE,QAAQ,EAAE;IACTC,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,IAAI;IACdC,MAAM,EAAE,IAAI;IACZC,SAAS,EAAE,IAAI;IACfC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE;EACR,CAAC;EACDC,QAAQ,EAAE;IACTP,IAAI,EAAEC;EACP,CAAC;EACDO,MAAM,EAAE;IACPR,IAAI,EAAEC;EACP,CAAC;EACDQ,KAAK,EAAE;IACNT,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,IAAI;IACdC,MAAM,EAAE,IAAI;IACZC,SAAS,EAAE,IAAI;IACfC,IAAI,EAAE;EACP,CAAC;EACDK,OAAO,EAAE;IACRV,IAAI,EAAEC;EACP,CAAC;EACDU,MAAM,EAAE;IACPX,IAAI,EAAEC,MAAM;IACZW,OAAO,EAAE;EACV,CAAC;EACDC,GAAG,EAAE;IAAEb,IAAI,EAAEC;EAAO,CAAC;EACrBa,UAAU,EAAE;IAAEd,IAAI,EAAEe;EAAK,CAAC;EAC1BC,KAAK,EAAE;IACNhB,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,IAAI;IACdC,MAAM,EAAE,IAAI;IACZC,SAAS,EAAE,IAAI;IACfC,IAAI,EAAE;EACP,CAAC;EACDY,OAAO,EAAE;IACRjB,IAAI,EAAEC;EACP,CAAC;EACDiB,IAAI,EAAE;IACLlB,IAAI,EAAEC;EACP,CAAC;EACDkB,KAAK,EAAE;IACNnB,IAAI,EAAEC;EACP,CAAC;EACDmB,OAAO,EAAE;IACRpB,IAAI,EAAEC;EACP,CAAC;EACDoB,GAAG,EAAE;IACJrB,IAAI,EAAEC;EACP,CAAC;EACDqB,eAAe,EAAE;IAChBtB,IAAI,EAAEuB;EACP,CAAC;EACDC,OAAO,EAAE;IACRxB,IAAI,EAAEuB;EACP,CAAC;EACDE,QAAQ,EAAE;IACTzB,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,CAAC,IAAI,EAAE,sBAAsB;EACxC,CAAC;EACDwB,YAAY,EAAE;IACb1B,IAAI,EAAEC;EACP;AACD,CAAC,EACD;EACC0B,UAAU,EAAE;AACb,CACD,CAAC;AAED7B,UAAU,CAAC8B,GAAG,CAAC,MAAM,EAAE,gBAAgBC,IAAI,EAAE;EAC5C,IAAI,CAAC,IAAI,CAACC,UAAU,CAAC,UAAU,CAAC,EAAE,OAAOD,IAAI,CAAC,CAAC;EAE/C,IAAI,CAACJ,QAAQ,GAAG,MAAM7B,MAAM,CAACmC,IAAI,CAAC,IAAI,CAACN,QAAQ,EAAE,EAAE,CAAC;EACpDI,IAAI,CAAC,CAAC;AACP,CAAC,CAAC;AAEF/B,UAAU,CAACkC,OAAO,CAACC,iBAAiB,GAAG,gBAAgBR,QAAQ,EAAE;EAChE,OAAO,MAAM7B,MAAM,CAACsC,OAAO,CAACT,QAAQ,EAAE,IAAI,CAACA,QAAQ,CAAC;AACrD,CAAC;AAED3B,UAAU,CAACkC,OAAO,CAACG,mBAAmB,GAAG,YAAY;EACpD,OAAOxC,GAAG,CAACyC,IAAI,CACd;IACCC,GAAG,EAAE,IAAI,CAACA,GAAG;IACb5B,KAAK,EAAE,IAAI,CAACA,KAAK;IACjBV,QAAQ,EAAE,IAAI,CAACA,QAAQ;IACvBQ,QAAQ,EAAE,IAAI,CAACA;EAChB,CAAC,EACD+B,OAAO,CAACC,GAAG,CAACC,mBAAmB,EAC/B;IACCC,SAAS,EAAEH,OAAO,CAACC,GAAG,CAACG;EACxB,CACD,CAAC;AACF,CAAC;AACD5C,UAAU,CAACkC,OAAO,CAACW,oBAAoB,GAAG,YAAY;EACrD,OAAOhD,GAAG,CAACyC,IAAI,CACd;IACCC,GAAG,EAAE,IAAI,CAACA;EACX,CAAC,EACDC,OAAO,CAACC,GAAG,CAACK,oBAAoB,EAChC;IACCH,SAAS,EAAEH,OAAO,CAACC,GAAG,CAACM;EACxB,CACD,CAAC;AACF,CAAC;AAED,MAAMC,IAAI,GAAGrD,QAAQ,CAACsD,KAAK,CAAC,MAAM,EAAEjD,UAAU,CAAC;AAC/CkD,MAAM,CAACC,OAAO,GAAGH,IAAI","ignoreList":[]}