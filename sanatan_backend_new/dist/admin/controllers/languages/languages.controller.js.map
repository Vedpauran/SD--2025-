{"version":3,"file":"languages.controller.js","names":["Language","require","asyncHandler","exports","getAllLanguages","req","res","languages","aggregate","$addFields","Date","$ifNull","json","err","status","message","getLanguageById","language","findById","params","id","FindLanguages","type","query","result","$facet","totals","$group","_id","published","$sum","$cond","$eq","draft","all","$project","activeLanguages","Status","adminName","Name","Icon","totalActive","totalDraft","$match","createLanguage","body","newLanguage","save","updateLanguage","set","updatedLanguage","deleteLanguage","findByIdAndDelete","deleteLanguages","ids","deleteMany","$in"],"sources":["../../../../src/admin/controllers/languages/languages.controller.js"],"sourcesContent":["// languageController.js\nconst Language = require(\"../../models/language\");\nconst asyncHandler = require(\"../../utils/asyncHandler\");\n// Get all languages\nexports.getAllLanguages = asyncHandler(async (req, res) => {\n\ttry {\n\t\tconst languages = await Language.aggregate([\n\t\t\t{\n\t\t\t\t$addFields: {\n\t\t\t\t\tDate: {\n\t\t\t\t\t\t$ifNull: [\"$Date\", \"$createdAt\"],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t]);\n\t\tres.json(languages);\n\t} catch (err) {\n\t\tres.status(500).json({ message: err.message });\n\t}\n});\n\n// Get language by ID\nexports.getLanguageById = asyncHandler(async (req, res) => {\n\ttry {\n\t\tconst language = await Language.findById(req.params.id);\n\t\tif (!language) {\n\t\t\treturn res.status(404).json({ message: \"Language not found\" });\n\t\t}\n\t\tres.json(language);\n\t} catch (err) {\n\t\tres.status(500).json({ message: err.message });\n\t}\n});\nexports.FindLanguages = asyncHandler(async (req, res) => {\n\tconst type = req.query.type;\n\n\ttry {\n\t\tif (type === \"\") {\n\t\t\tconst result = await Language.aggregate([\n\t\t\t\t{\n\t\t\t\t\t$facet: {\n\t\t\t\t\t\ttotals: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$group: {\n\t\t\t\t\t\t\t\t\t_id: null,\n\t\t\t\t\t\t\t\t\tpublished: {\n\t\t\t\t\t\t\t\t\t\t$sum: {\n\t\t\t\t\t\t\t\t\t\t\t$cond: [\n\t\t\t\t\t\t\t\t\t\t\t\t{ $eq: [\"$Status\", \"STATUS_ACTIVE\"] },\n\t\t\t\t\t\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tdraft: {\n\t\t\t\t\t\t\t\t\t\t$sum: {\n\t\t\t\t\t\t\t\t\t\t\t$cond: [\n\t\t\t\t\t\t\t\t\t\t\t\t{ $eq: [\"$Status\", \"STATUS_INACTIVE\"] },\n\t\t\t\t\t\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tall: { $sum: 1 },\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$project: {\n\t\t\t\t\t\t\t\t\t_id: 0,\n\t\t\t\t\t\t\t\t\tpublished: 1,\n\t\t\t\t\t\t\t\t\tdraft: 1,\n\t\t\t\t\t\t\t\t\tall: 1,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tactiveLanguages: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$project: {\n\t\t\t\t\t\t\t\t\t_id: 1,\n\t\t\t\t\t\t\t\t\tStatus: 1,\n\t\t\t\t\t\t\t\t\tadminName: 1,\n\t\t\t\t\t\t\t\t\tName: 1,\n\t\t\t\t\t\t\t\t\tIcon: 1,\n\t\t\t\t\t\t\t\t\tDate: {\n\t\t\t\t\t\t\t\t\t\t$ifNull: [\"$Date\", \"$createdAt\"],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t]);\n\t\t\tres.json({\n\t\t\t\ttotals: result[0].totals[0] || {\n\t\t\t\t\ttotalActive: 0,\n\t\t\t\t\ttotalDraft: 0,\n\t\t\t\t},\n\t\t\t\tactiveLanguages: result[0].activeLanguages,\n\t\t\t});\n\t\t} else {\n\t\t\tconst result = await Language.aggregate([\n\t\t\t\t{\n\t\t\t\t\t$facet: {\n\t\t\t\t\t\ttotals: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$group: {\n\t\t\t\t\t\t\t\t\t_id: null,\n\t\t\t\t\t\t\t\t\tpublished: {\n\t\t\t\t\t\t\t\t\t\t$sum: {\n\t\t\t\t\t\t\t\t\t\t\t$cond: [\n\t\t\t\t\t\t\t\t\t\t\t\t{ $eq: [\"$Status\", \"STATUS_ACTIVE\"] },\n\t\t\t\t\t\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tdraft: {\n\t\t\t\t\t\t\t\t\t\t$sum: {\n\t\t\t\t\t\t\t\t\t\t\t$cond: [\n\t\t\t\t\t\t\t\t\t\t\t\t{ $eq: [\"$Status\", \"STATUS_INACTIVE\"] },\n\t\t\t\t\t\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tall: { $sum: 1 },\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$project: {\n\t\t\t\t\t\t\t\t\t_id: 0,\n\t\t\t\t\t\t\t\t\tpublished: 1,\n\t\t\t\t\t\t\t\t\tdraft: 1,\n\t\t\t\t\t\t\t\t\tall: 1,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tactiveLanguages: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$match: { Status: type },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$project: {\n\t\t\t\t\t\t\t\t\t_id: 1,\n\t\t\t\t\t\t\t\t\tStatus: 1,\n\t\t\t\t\t\t\t\t\tadminName: 1,\n\t\t\t\t\t\t\t\t\tName: 1,\n\t\t\t\t\t\t\t\t\tIcon: 1,\n\t\t\t\t\t\t\t\t\tDate: {\n\t\t\t\t\t\t\t\t\t\t$ifNull: [\"$Date\", \"$createdAt\"],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t]);\n\t\t\tres.json({\n\t\t\t\ttotals: result[0].totals[0] || {\n\t\t\t\t\ttotalActive: 0,\n\t\t\t\t\ttotalDraft: 0,\n\t\t\t\t},\n\t\t\t\tactiveLanguages: result[0].activeLanguages,\n\t\t\t});\n\t\t}\n\t} catch (err) {\n\t\tres.status(500).json({ message: err.message });\n\t}\n});\n// Create a new language\nexports.createLanguage = asyncHandler(async (req, res) => {\n\tconst language = new Language(req.body);\n\n\ttry {\n\t\tconst newLanguage = await language.save();\n\t\tres.status(201).json(newLanguage);\n\t} catch (err) {\n\t\tres.status(400).json({ message: err.message });\n\t}\n});\n\n// Update language by ID\nexports.updateLanguage = asyncHandler(async (req, res) => {\n\ttry {\n\t\tconst language = await Language.findById(req.params.id);\n\t\tif (!language) {\n\t\t\treturn res.status(404).json({ message: \"Language not found\" });\n\t\t}\n\n\t\tlanguage.set(req.body);\n\t\tconst updatedLanguage = await language.save();\n\t\tres.json(updatedLanguage);\n\t} catch (err) {\n\t\tres.status(400).json({ message: err.message });\n\t}\n});\n\n// Delete language by ID\nexports.deleteLanguage = asyncHandler(async (req, res) => {\n\ttry {\n\t\tconst language = await Language.findById(req.params.id);\n\n\t\tif (!language) {\n\t\t\treturn res.status(404).json({ message: \"Language not found\" });\n\t\t}\n\n\t\tawait Language.findByIdAndDelete(req.params.id);\n\n\t\tres.json({ message: \"Language deleted successfully\" });\n\t} catch (err) {\n\t\tres.status(500).json({ message: err.message });\n\t}\n});\n\n// Delete Multiple languages by ID\nexports.deleteLanguages = asyncHandler(async (req, res) => {\n\ttry {\n\t\tvar ids = req.body;\n\n\t\tawait Language.deleteMany({ _id: { $in: ids } });\n\n\t\tres.json({ message: \"Languages deleted successfully\" });\n\t} catch (err) {\n\t\tres.status(500).json({ message: err.message });\n\t}\n});\n"],"mappings":"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","ignoreList":[]}