{"version":3,"file":"subCategory.js","names":["express","require","router","Router","mongoose","Category","mainCategory","Subcategory","ObjectId","get","req","res","category","find","status","json","error","message","id","params","main","aggregate","$match","Parent","$lookup","from","localField","foreignField","as","post","cat","create","body","put","_id","UpdateCategory","findByIdAndUpdate","getcat","next","findById","delete","CatDelete","deleteOne","msg","module","exports"],"sources":["../../../../src/admin/routes/category/subCategory.js"],"sourcesContent":["const express = require(\"express\");\nconst router = express.Router();\nconst mongoose = require(\"mongoose\");\nconst Category = require(\"../../models/category/subCategory.model\");\nconst mainCategory = require(\"../../models/category/mainCategory.model\");\nconst Subcategory = require(\"../../models/category/subCategory.model\");\nconst { ObjectId } = require(\"mongodb\");\n\nrouter.get(\"/\", async (req, res) => {\n\ttry {\n\t\tconst category = await Category.find();\n\t\tres.status(201).json(category);\n\t} catch (error) {\n\t\tres.status(500).json({ message: error.message });\n\t}\n});\n\nrouter.get(\"/find/:main\", async (req, res) => {\n\ttry {\n\t\tconst id = req.params.main;\n\t\tconst category = await Subcategory.aggregate([\n\t\t\t{\n\t\t\t\t$match: {\n\t\t\t\t\tParent: new ObjectId(id),\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\t$lookup: {\n\t\t\t\t\tfrom: \"maincategories\",\n\t\t\t\t\tlocalField: \"Parent\",\n\t\t\t\t\tforeignField: \"_id\",\n\t\t\t\t\tas: \"mainCategory\",\n\t\t\t\t},\n\t\t\t},\n\t\t]);\n\t\tres.status(201).json(category);\n\t} catch (error) {\n\t\tres.status(500).json({ message: error.message });\n\t}\n});\n\nrouter.post(\"/add\", async (req, res) => {\n\ttry {\n\t\tconst cat = await Category.create(req.body);\n\t\tres.status(200).json(cat);\n\t} catch (error) {\n\t\tres.status(500).json({ message: error.message });\n\t}\n});\n\nrouter.put(\"/:id\", async (req, res) => {\n\tconst _id = req.params.id;\n\ttry {\n\t\tconst UpdateCategory = await Category.findByIdAndUpdate(\n\t\t\t_id,\n\t\t\treq.body\n\t\t);\n\t\tres.status(200).json(\"success\");\n\t} catch (error) {\n\t\tres.status(500).json({ message: error.message });\n\t}\n});\n\nrouter.get(\"/:id\", getcat, (req, res) => {\n\tres.json(res.category);\n});\nasync function getcat(req, res, next) {\n\ttry {\n\t\tconst category = await Category.findById(req.params.id);\n\t\tif (!category) {\n\t\t\treturn res.status(404).json({ message: \"Not Found\" });\n\t\t}\n\t\tres.category = category;\n\t\tres.json(res.category);\n\t} catch (error) {\n\t\treturn res.status(500).json({ message: error.message });\n\t}\n}\n\nrouter.delete(\"/:id\", async (req, res) => {\n\tconst _id = req.params.id;\n\ttry {\n\t\tconst CatDelete = await Category.deleteOne({ _id });\n\t\tres.status(200).json({ msg: \"Successfully Deleted\" });\n\t} catch (error) {\n\t\tres.status(500).json({ message: error.message });\n\t}\n});\n\nmodule.exports = router;\n"],"mappings":"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","ignoreList":[]}